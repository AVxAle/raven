<?xml version="1.0" encoding="UTF-8"?>
<Simulation verbosity='debug'>
<RunInfo>
    <WorkingDir>test_merge_2_databases</WorkingDir>
    <Files>ideal_pump.i,ideal_pump_control.py</Files>
    <Sequence>MonteCarlo,test_extract,test_push_in,test_extract_again</Sequence>
    <batchSize>1</batchSize>
</RunInfo>
<Models>
    <Code name='MyRAVEN' subType='RAVEN'><executable>%FRAMEWORK_DIR%/../RAVEN-%METHOD%</executable></Code>
</Models>
<Samplers>
  <MonteCarlo     name='RAVENmc3'  limit='10' initial_seed='1'>
      <sampler_init>
          <limit>10</limit>
          <initial_seed>1</initial_seed>
      </sampler_init>
  </MonteCarlo>
</Samplers>
<Steps>
    <MultiRun name='MonteCarlo'>
        <Input   class='Files'      type=''          >ideal_pump.i</Input>
        <Input   class='Files'      type=''          >ideal_pump_control.py</Input>
        <Model   class='Models'     type='Code'      >MyRAVEN</Model>
        <Sampler class='Samplers'   type='MonteCarlo'>RAVENmc3</Sampler>
        <Output  class='Databases'  type='HDF5'      >MC_MERGE_EXTRACT_STEP</Output>
    </MultiRun>
    <IOStep name='test_extract'>
        <Input   class='Databases' type='HDF5'   >MC_MERGE_EXTRACT_STEP</Input>
        <Output  class='DataObjects'    type='Histories'>histories_from_database</Output>
        <Input   class='Databases' type='HDF5'   >MC_MERGE_EXTRACT_STEP</Input>
        <Output  class='DataObjects'    type='Histories'>histories_from_database</Output>
        
        <Input   class='Databases' type='HDF5'   >MC_MERGE_EXTRACT_STEP</Input>
        <Output  class='DataObjects'    type='TimePoint'>timepoint_from_database</Output>
        <Input   class='Databases' type='HDF5'   >MC_MERGE_EXTRACT_STEP</Input>
        <Output  class='DataObjects'    type='TimePoint'>timepoint_from_database</Output>
        
        <Input   class='Databases' type='HDF5'   >MC_MERGE_EXTRACT_STEP</Input>
        <Output  class='DataObjects'    type='History'>history_from_database</Output>
        <Input   class='Databases' type='HDF5'   >MC_MERGE_EXTRACT_STEP</Input>
        <Output  class='DataObjects'    type='History'>history_from_database</Output>
        
        <Input   class='Databases' type='HDF5'   >MC_MERGE_EXTRACT_STEP</Input>
        <Output  class='DataObjects'    type='TimePointSet'>timepointset_from_database</Output>
        <Input   class='Databases' type='HDF5'   >MC_MERGE_EXTRACT_STEP</Input>
        <Output  class='DataObjects'    type='TimePointSet'>timepointset_from_database</Output>
        <Output    class='OutStreamManager' type='Print'     >timepointset_from_database_dump</Output>
    </IOStep>
    <IOStep name='test_push_in'>
        <Input  class='DataObjects'    type='Histories'>histories_from_database</Input>
        <Output   class='Databases' type='HDF5'   >MC_MERGE_PUSH_STEP</Output>
        <Input  class='DataObjects'    type='TimePoint'>timepoint_from_database</Input>
        <Output   class='Databases' type='HDF5'   >MC_MERGE_PUSH_STEP</Output>
        <Input  class='DataObjects'    type='History'>history_from_database</Input>
        <Output   class='Databases' type='HDF5'   >MC_MERGE_PUSH_STEP</Output>
        <Input  class='DataObjects'    type='TimePointSet'>timepointset_from_database</Input>
        <Output   class='Databases' type='HDF5'   >MC_MERGE_PUSH_STEP</Output>
    </IOStep>
    <IOStep name='test_extract_again'>
        <Input   class='Databases' type='HDF5'   >MC_MERGE_PUSH_STEP</Input>
        <Output  class='DataObjects'    type='Histories'>histories_IN_database</Output>
        <Input   class='Databases' type='HDF5'   >MC_MERGE_PUSH_STEP</Input>
        <Output  class='DataObjects'    type='TimePoint'>timepoint_IN_database</Output>
        <Input   class='Databases' type='HDF5'   >MC_MERGE_PUSH_STEP</Input>
        <Output  class='DataObjects'    type='History'>history_IN_database</Output>
        <Input   class='Databases' type='HDF5'   >MC_MERGE_PUSH_STEP</Input>
        <Output  class='DataObjects'    type='TimePointSet'>timepointset_IN_database</Output>
        <Output  class='OutStreamManager' type='Print'     >timepointset_IN_database_dump</Output>
    </IOStep>
</Steps>
<Databases>
        <HDF5 name="MC_MERGE_EXTRACT_STEP"/>
        <HDF5 name="MC_MERGE_PUSH_STEP"/>
</Databases>
<OutStreamManager>
  <Print name='timepointset_from_database_dump'>
    <type>csv</type>
    <source>timepointset_from_database</source>
  </Print>
  <Print name='timepointset_IN_database_dump'>
    <type>csv</type>
    <source>timepointset_IN_database</source>
  </Print>

</OutStreamManager>


<DataObjects>
   <Histories name='histories_from_database' printCSV='t' inputTs='1'>
        <Input>dummy_for_branch</Input>
        <Output>pipe1_Hw,pump_mass_flow_rate,time</Output>
   </Histories>
   <TimePoint name='timepoint_from_database' printCSV='t' inputTs='1'>
       <Input name="1">dummy_for_branch</Input>
       <Output>pipe1_Hw,pump_mass_flow_rate,time</Output>
   </TimePoint>
   <History name='history_from_database' printCSV='t' inputTs='1'>
       <Input name="1">dummy_for_branch</Input>
       <Output>pipe1_Hw,pump_mass_flow_rate,time</Output>
   </History>
   <TimePointSet name='timepointset_from_database' printCSV='t' inputTs='1'>
       <Input>dummy_for_branch</Input>
       <Output>pipe1_Hw,pump_mass_flow_rate,time</Output>
   </TimePointSet>
   <Histories name='histories_IN_database' printCSV='t' inputTs='1'>
       <Input>dummy_for_branch</Input>
       <Output>pipe1_Hw,pump_mass_flow_rate,time</Output>
   </Histories>
   <TimePoint name='timepoint_IN_database' printCSV='t' inputTs='1'>
       <Input name="histories_from_database|0">dummy_for_branch</Input>
       <Output>pipe1_Hw,pump_mass_flow_rate,time</Output>
   </TimePoint>
   <History name='history_IN_database' printCSV='t' inputTs='1'>
       <Input name="histories_from_database|0">dummy_for_branch</Input>
       <Output>pipe1_Hw,pump_mass_flow_rate,time</Output>
   </History>
   <TimePointSet name='timepointset_IN_database' printCSV='t' inputTs='1'>
       <Input>dummy_for_branch</Input>
       <Output>pipe1_Hw,pump_mass_flow_rate,time</Output>
   </TimePointSet>
</DataObjects>
</Simulation>
