<?xml version="1.0" encoding="UTF-8"?>
<Simulation>
<RunInfo>
    <WorkingDir>/Users/mandd/projects/raven/tests/framework/ND_test</WorkingDir>
    <Files>lorentzAttractor.py,TriangularExponential2D_scattered.txt,TriangularExponential2D_cartesian.txt,covMatrix.txt</Files>
    <Sequence>FirstMRun</Sequence>
    <batchSize>1</batchSize>
</RunInfo>

<Models>
    <ExternalModel name='PythonModule' subType='' ModuleToLoad='ND_test/lorentzAttractor'>
        <variable>sigma</variable>
        <variable>rho</variable>
        <variable>beta</variable>
        <variable>x</variable>
        <variable>y</variable>
        <variable>z</variable>
        <variable>k</variable>
        <variable>time</variable>
        <variable>x0</variable>
        <variable>y0</variable>
        <variable>z0</variable>
        <variable>k0</variable>
    </ExternalModel>
</Models>

<Distributions>
    <NDInverseWeight name='testInverse'>
        <p>2.5</p>
        <data_filename type='CDF'>TriangularExponential2D_scattered.txt</data_filename>
        <working_dir>/Users/mandd/projects/raven/tests/framework/ND_test/</working_dir>
    </NDInverseWeight>
    <Normal name='k0_distrib'>
        <mean>4</mean>
        <sigma>1</sigma>
    </Normal>
</Distributions>

<Samplers>
    <!-- <MonteCarlo name='MC_external'  limit='3'>
        <variable name='k0'>
            <distribution>k0_distrib</distribution>
        </variable>
        <variable name='x0;y0,z0'>
            <distribution>testInverse</distribution>
            <dist_init>
                <initial_grid_disc>10</initial_grid_disc>
                <tolerance>0.1</tolerance>
            </dist_init>
        </variable>
    </MonteCarlo> -->
     
    <MonteCarlo name='MC_external'>
        <sampler_init>
            <limit>10</limit>
            <initial_seed>1234</initial_seed>
            <dist_init>
                <distribution name= "ND_InverseWeight">
                  <initial_grid_disc>10</initial_grid_disc>
                  <tolerance>0.1</tolerance>
                </distribution>
                <distribution name="ND_Spline">
                    <initial_grid_disc>10</initial_grid_disc>
                    <tolerance>0.1</tolerance>
                </distribution>
            </dist_init>
        </sampler_init>
        <variable name='k0'>
            <distribution>k0_distrib</distribution>
        </variable>
        <variable name='x0'>
            <distribution dim='1'>testInverse</distribution>
        </variable>
        <variable name='y0,z0'>
            <distribution dim='2'>testInverse</distribution>
        </variable>
    </MonteCarlo>
    
    <!-- <Grid name='grid_CDF'>
        <variable name='k0'>
            <distribution>k0_distrib</distribution>
            <grid type='CDF' construction='custom'>0.5 1.0 0.0</grid>
        </variable>
        <variable name='x0;y0,z0'>
            <distribution>testInverse</distribution>
            <grid type='CDF' construction='custom'>0.5 2.0 1.0</grid>
        </variable>
    </Grid> -->
    <Grid name='grid_value'>
        <variable name='k0'>
            <distribution>k0_distrib</distribution>
            <grid type='value' construction='custom'>10.5 11.0 10.0</grid>
        </variable>
        <variable name='x0'>
            <distribution dim='1'>testInverse</distribution>
            <grid type='value' construction='custom'>30.5 31.0 30.0</grid>
        </variable>
        <variable name='y0,z0'>
            <distribution dim='2'>testInverse</distribution>
            <grid type='value' construction='custom'>20.5 21.0 20.0</grid>
        </variable>
    </Grid>

    <!--<Grid name='grid_value'>
        <variable name='k0'>
            <distribution>k0_distrib</distribution>
            <grid type='value' construction='custom'>10.5 11.0 10.0</grid>
        </variable>
        <variable name='x0;y0,z0'>
            <distribution>testInverse</distribution>
            <grid name='x0'    type='value' construction='custom'>20.5 21.0 20.0</grid>
            <grid name='y0,z0' type='value' construction='custom'>30.5 31.0 30.0</grid>
        </variable>
    </Grid>-->
</Samplers>

<Steps>
    <MultiRun name='FirstMRun' re-seeding='1'>
        <Input   class='Files'              type=''               >lorentzAttractor.py</Input>
        <Model   class='Models'             type='ExternalModel'  >PythonModule</Model>
        <Sampler class='Samplers'           type='Grid'           >grid_value</Sampler>
        <Output  class='Datas'              type='Histories'      >testPrintHistories</Output>
        <Output  class='OutStreamManager'   type='Print'          >testPrintHistories_dump</Output>
    </MultiRun >
</Steps>

<OutStreamManager>
    <Print name='testPrintHistories_dump'>
        <type>csv</type>
        <source>testPrintHistories</source>
    </Print>
</OutStreamManager>


<Datas>
    <Histories name='testPrintHistories'>
        <Input>x0,y0,z0,k0</Input>
        <Output>time,x,y,z,k</Output>
    </Histories>
</Datas>

</Simulation>



