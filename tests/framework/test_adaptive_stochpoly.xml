<?xml version="1.0" encoding="UTF-8"?>
<Simulation verbosity="debug">
    <RunInfo>
        <WorkingDir>AdaptiveStochasticPoly</WorkingDir>
        <Sequence>make,train,print,print2</Sequence>
        <batchSize>1</batchSize>
    </RunInfo>

    <Steps>
        <MultiRun name='make' verbosity='silent'>
            <Sampler class='Samplers'    type='AdaptiveSparseGrid'   >SG</Sampler>
            <Input   class='DataObjects' type='TimePointSet'         >dummyIN</Input>
            <Model   class='Models'      type='ExternalModel'        >poly</Model>
            <Output  class='DataObjects' type='TimePointSet'         >solns</Output>
        </MultiRun>
        <RomTrainer name='train' verbosity='silent'>
            <Input   class='DataObjects' type='TimePointSet'>solns</Input>
            <Output  class='Models'      type='ROM'         >rom</Output>
        </RomTrainer>
        <IOStep name='print' verbosity='silent'>
            <Input  class='Models'           type='ROM'         >rom</Input>
            <Output class='OutStreamManager' type='Print'       >dump</Output>
        </IOStep>
        <IOStep name='print2' verbosity='silent'>
            <Input  class='DataObjects'      type='TimePointSet'>solns</Input>
            <Output class='OutStreamManager' type='Print'       >data</Output>
        </IOStep>
    </Steps>

    <Distributions>
        <Uniform name="UniDist"><lowerBound>-1</lowerBound><upperBound>1</upperBound></Uniform>
    </Distributions>

    <Samplers>
        <AdaptiveSparseGrid name="SG" verbosity='debug'>
            <Convergence target='coeffs'>1e-2</Convergence>
            <variable name="x1"><distribution>UniDist</distribution></variable>
            <variable name="x2"><distribution>UniDist</distribution></variable>
            <ROM              class = 'Models'      type = 'ROM'         >rom</ROM>
            <TargetEvaluation class = 'DataObjects' type = 'TimePointSet'>solns</TargetEvaluation>
        </AdaptiveSparseGrid>
    </Samplers>

    <Models>
        <Dummy name="MyDummy" subType="" print="True"/>
        <ExternalModel name='poly' subType='' ModuleToLoad='AdaptiveStochasticPoly/polynomial' verbosity='silent'>
            <variable>x1</variable>
            <variable>x2</variable>
            <variable>ans</variable>
        </ExternalModel>
        <ROM name='rom' subType='GaussPolynomialRom' verbosity='silent'>
            <Target>ans</Target>
            <Features>x1,x2</Features>
            <IndexSet>TotalDegree</IndexSet>
            <PolynomialOrder>1</PolynomialOrder>
            <!--Interpolation quad='ClenshawCurtis'>x1</Interpolation>
            <Interpolation quad='ClenshawCurtis'>x2</Interpolation-->
        </ROM>
    </Models>

    <DataObjects>
        <TimePointSet name="dummyIN" verbosity='silent'>
            <Input>x1,x2</Input>
            <Output>OutputPlaceHolder</Output>
        </TimePointSet>
        <TimePointSet name='solns' verbosity='silent'>
            <Input>x1,x2</Input>
            <Output>ans</Output>
        </TimePointSet>
    </DataObjects>

    <OutStreamManager>
        <Print name='dump' verbosity='silent'>
           <type>xml</type>
           <source>rom</source>
           <what>mean,variance</what>
           <target>all</target>
        </Print>
        <Print name='data' verbosity='silent'>
           <type>csv</type>
           <source>solns</source>
        </Print>
    </OutStreamManager>
</Simulation>
