<?xml version="1.0" encoding="UTF-8"?>
<Simulation debug="True">
<RunInfo>
    <WorkingDir>branch</WorkingDir>
    <Files>ideal_pump.i,ideal_pump_control.py,DET_histories.csv</Files>
    <Sequence>DETrunTest,extract_hist_example</Sequence>
    <batchSize>4</batchSize>
</RunInfo>

<Models>
    <Code name='MyRAVEN' subType='RAVEN'><executable>%FRAMEWORK_DIR%/../RAVEN-%METHOD%</executable></Code>
    <PostProcessor name="csv_from_hdf5" subType='PrintCSV'>
        <paramters>all</paramters>
    </PostProcessor>
</Models>

<Distributions>
  <Uniform name="zeroToOne">
    <low>0.0</low>
    <hi>1.0</hi>
  </Uniform>
</Distributions>

<Samplers>
  <DynamicEventTree name='DET_test' print_end_xml="True">
      <Distribution name='zeroToOne'>
          <distribution >zeroToOne</distribution>
          <grid type='CDF' construction='custom'>0.1 0.5 0.8</grid>
      </Distribution>
      <!--
      <variable name='zeroToOne' >
        <distribution ProbabilityThresholds='0.1 0.5 0.8'>zeroToOne</distribution>
      </variable> 
      -->
  </DynamicEventTree>   
</Samplers>
<OutStreamManager>
  <Print name='testprint_hist_hier'>
    <type>csv</type>
    <source>stories</source>
  </Print>
  <Print name='testprint_tpset_hier'>
    <type>csv</type>
    <source>timepointset</source>
  </Print>
  <Print name='testprint_hist_hier_variables'>
    <type>csv</type>
    <source>stories</source>
    <variables>Output,Input|dummy_for_branch</variables>
  </Print>
  <Print name='testprint_tpset_hier_variables'>
    <type>csv</type>
    <source>timepointset</source>
    <variables>Output,Input|dummy_for_branch</variables>
  </Print>
  <Plot name='2DHistoryPlot' dim='2' interactive='False' overwrite='False'>
        <plotSettings>
            <plot>
                <type>line</type>
                <x>stories|Output|time</x>
                <y>stories|Output|pump_mass_flow_rate</y>
                <kwargs>
                    <color>green</color>
                    <label>pipe1-Hw</label>
                </kwargs>
            </plot>
            <xlabel>time [s]</xlabel>
            <ylabel>evolution</ylabel>
        </plotSettings>
        <actions>
            <how>pdf</how>
            <title>
                <text> </text>
            </title>
        </actions>
  </Plot>
    <Plot name='2DHistoryPlot_tps' dim='2' interactive='False' overwrite='False'>
        <plotSettings>
            <plot>
                <type>scatter</type>
                <x>timepointset|Output|time</x>
                <y>timepointset|Output|pump_mass_flow_rate</y>
                <kwargs>
                    <color>green</color>
                    <label>pipe1-Hw</label>
                </kwargs>
            </plot>
            <xlabel>time [s]</xlabel>
            <ylabel>evolution</ylabel>
        </plotSettings>
        <actions>
            <how>pdf</how>
            <title>
                <text> </text>
            </title>
        </actions>
    </Plot>
</OutStreamManager>
<Steps>
    <MultiRun name='DETrunTest'>
        <Input   class='Files'            type=''                >ideal_pump.i</Input>
        <Input   class='Files'            type=''                >ideal_pump_control.py</Input>
        <Model   class='Models'           type='Code'            >MyRAVEN</Model>
        <Sampler class='Samplers'         type='DynamicEventTree'>DET_test</Sampler>
        <Output  class='DataBases'        type='HDF5'            >testBranchDataBase</Output>
        <Output  class='Datas'            type='Histories'       >stories</Output>
        <Output  class='Datas'            type='TimePointSet'    >timepointset</Output>
        <Output  class='OutStreamManager' type='Print'           >testprint_hist_hier</Output>
        <Output  class='OutStreamManager' type='Print'           >testprint_tpset_hier</Output>
        <Output  class='OutStreamManager' type='Print'           >testprint_hist_hier_variables</Output>
        <Output  class='OutStreamManager' type='Print'           >testprint_tpset_hier_variables</Output>
        <Output  class='OutStreamManager' type='Plot'            >2DHistoryPlot</Output>
        <Output  class='OutStreamManager' type='Plot'            >2DHistoryPlot_tps</Output>
    </MultiRun >
    <SingleRun name='extract_hist_example'>
        <Input   class='DataBases'        type='HDF5'            >testBranchDataBase</Input>
        <Model   class='Models'           type='PostProcessor'   >csv_from_hdf5</Model>
        <Output  class='Files'            type=''                >DET_histories.csv</Output>
    </SingleRun>      
</Steps>
<DataBases>
    <HDF5 name="testBranchDataBase"/> 
</DataBases>
<Datas>
    <Histories name='stories' hierarchical='true'>
        <Input>dummy_for_branch</Input>
        <Output>pump_mass_flow_rate,time</Output>
   </Histories>
    <TimePointSet name='timepointset' hierarchical='true'>
        <Input>dummy_for_branch</Input>
        <Output>pump_mass_flow_rate,time</Output>
    </TimePointSet>
</Datas>
</Simulation>



