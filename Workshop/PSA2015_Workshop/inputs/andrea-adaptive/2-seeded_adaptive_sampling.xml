<Simulation>
	

<RunInfo>
  <WorkingDir>/Users/alfoa/projects/trunk_git/raven/Workshop/PSA2015_Workshop/inputs/andrea-adaptive/results</WorkingDir>
  <Sequence>adapt,adaptdump</Sequence>
  <batchSize>50</batchSize>
</RunInfo>


<Steps>  

  <MultiRun name = 'adapt' pauseAtEnd = 'True'>
    <Sampler          class = 'Samplers'  type = 'Adaptive'      >dpt_smp</Sampler>
    <Input            class = 'DataObjects'     type = 'TimePointSet'  >bln_smp_dt</Input>   
    <Model            class = 'Models'    type = 'ExternalModel' >xtr_mdl</Model>
    <Output           class = 'DataObjects'     type = 'TimePointSet'  >nt_phy_dpt_dt</Output>            
    <SolutionExport   class = 'DataObjects'     type = 'TimePointSet'  >lmt_srf_dt</SolutionExport>
  </MultiRun>
  <OutStreamStep name = 'adaptdump' pauseAtEnd = 'True'>
  	<Input  class = 'DataObjects'            type = 'TimePointSet'  >lmt_srf_dt</Input>
  	<Output class = 'OutStreamManager'       type = 'Print'         >limitSurfaceDump</Output>
  </OutStreamStep>
</Steps>

<DataObjects> 
  
  <TimePointSet name = 'nt_phy_dpt_dt'>
    <Input>x1,x2,gammay</Input>
    <Output>g</Output>
  </TimePointSet>
    
  <TimePointSet name = 'bln_smp_dt'>
    <Input>x1,x2,gammay</Input>
    <Output>OutputPlaceHolder</Output>
  </TimePointSet>
    
  <TimePointSet name = 'lmt_srf_dt'>
    <Input>x1,x2,gammay</Input>
    <Output>g_zr</Output>
  </TimePointSet>
  
</DataObjects>


<Distributions>
  <Normal name = 'x1_dst'>
    <upperBound>10</upperBound>
    <lowerBound>-10</lowerBound>
  	<mean>0.5</mean>
    <sigma>0.1</sigma>
  </Normal>
  
  <Normal name = 'x2_dst'>
    <upperBound>10</upperBound>
    <lowerBound>-10</lowerBound>
    <mean>-0.15</mean>
    <sigma>0.05</sigma>
  </Normal>
  
  <Normal name = 'gammay_dst'>
    <upperBound>20</upperBound>
    <lowerBound>-20</lowerBound>
    <mean>0</mean>
    <sigma>15</sigma>
  </Normal>
</Distributions>


<Samplers>  

  <Adaptive name = 'dpt_smp'>
    <ROM              class = 'Models'    type = 'ROM'           >accelerated_ROM</ROM>
    <Function         class = 'Functions' type = 'External'      >g_zr</Function>
    <TargetEvaluation class = 'DataObjects'     type = 'TimePointSet'  >nt_phy_dpt_dt</TargetEvaluation>
    <Convergence limit = '3000' forceIteration = 'False' weight = 'value' persistence = '25'>9e-2</Convergence>
      <variable name = 'x1'>
        <distribution>x1_dst</distribution>
      </variable>
      <variable name = 'x2'>
        <distribution>x2_dst</distribution>
      </variable>
      <variable name = 'gammay'>
        <distribution>gammay_dst</distribution>
      </variable>
  </Adaptive>
</Samplers>


<Models>  
  <ExternalModel name = 'xtr_mdl' subType = '' ModuleToLoad = 'Adapt/adaptive_test_model'>
    <variable>x1</variable>
    <variable>x2</variable>
    <variable>gammay</variable>
    <variable>g</variable>
  </ExternalModel>
  
  <ROM name = 'accelerated_ROM' subType = 'SciKitLearn'>
    <Features>x1,x2,gammay</Features>
    <Target>g_zr</Target>
    <SKLtype>svm|SVC</SKLtype>
    <kernel>rbf</kernel>
    <gamma>10</gamma>
    <tol>1e-5</tol>
    <C>50</C>
  </ROM>  
  
</Models>


<Functions>
  <External name='g_zr' file='Adapt/adaptive_test_goal'>
    <variable>g</variable>
  </External>
</Functions>


<OutStreamManager> 
  <Print name = 'limitSurfaceDump'>
  	<type>csv</type>
  	<source>lmt_srf_dt</source>
  </Print>
  
</OutStreamManager>



</Simulation>
