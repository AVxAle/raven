<?xml version="1.0" encoding="UTF-8"?>
<Simulatio>
<RunInfo>
    <WorkingDir>./inputs_for_report</WorkingDir>
    <Files>TMI_test_PRA_transient_less_w_ss_out_restart_0831.rd-0,TMI_PRA_trans_MC_control.py,TMI_PRA_trans_SC_control.py,TMI.i,TMI_SC.i,TMI_test_PRA_transient_less_w_ss_out_restart_0831_mesh.xda,TMI_test_PRA_transient_less_w_ss_out_restart_0831.xda</Files>
    <Sequence>set_up_StochCollocation,create_ROM,sample_SC_ROM,solve_MC</Sequence>
    <!--Sequence>set_up_SC,create_ROM,sample_SC_ROM,solve_MC</Sequence-->
    <mode>pbs</mode>
    <batchSize>400</batchSize>
</RunInfo>

<Models>
    <Code name='MyRAVEN' type='RAVEN'>../RAVEN-opt</Code>
    <ROM  name='SCrom'   type='StochasticPolynomials'>SCrom</ROM>
</Models>
<Distributions>
    <Normal name='crew1DG1'>
        <mean>800</mean>
        <sigma>200</sigma>
    </Normal>
    <Normal name='crewSecPG'>
        <mean>1400</mean>
        <sigma>400</sigma>
    </Normal>
    <Uniform name='crew1DG2CoupledDG1'>
        <low>0.5</low>
        <hi>1.0</hi>
    </Uniform>
    <Normal name='PrimPGrecovery'>
        <mean>2000</mean>
        <sigma>500</sigma>
    </Normal>
    <Normal name='CladFailureDist'>
        <mean>1477.59</mean>
        <sigma>100.0</sigma>
    </Normal>
</Distributions>


<Samplers>
  <StochasticCollocation name='SC' min_poly_order='6'>
      <Variable type ='Normal'  distName='crew1DG1'            polyOrder='2'>RavenAuxiliary|DG1recoveryTime|initial_value</Variable>
      <Variable type ='Uniform' distName='crew1DG2CoupledDG1'  polyOrder='2'>RavenAuxiliary|crew1DG2CoupledDG1|initial_value</Variable>
      <Variable type ='Normal'  distName='crewSecPG'           polyOrder='2'>RavenAuxiliary|SecPGrecoveryTime|initial_value</Variable>
      <!-- 
        As input space for the ROM, the Clad FailureDist does not make a lot of sense... But for future pps we want
        to have this info (in order to compare with the MC calculation). For this reason, in the RAVEN/RELAP7 input 
        we do not make the code fail when the max temperature of the clad > of the sampled FailureDist, the response of the ROM
        will not depend on this parameter (even if we set a bool variable to true when maxTemp>LimitTemp)
      -->
      <Variable type ='Normal'  distName='CladFailureDist'     polyOrder='2'>RavenAuxiliary|CladTempBranched|initial_value</Variable>
      <Variable type ='Normal'  distName='PrimPGrecovery'      polyOrder='2'>RavenAuxiliary|PrimPGrecoveryTime|initial_value</Variable>
  </StochasticCollocation>
  <MonteCarlo     name='MC'    limit='400' initial_seed='20'>
      <!-- 
      <Variable type ='Uniform' distName='Uni1' >RavenAuxiliary|DG1recoveryTime|initial_value</Variable>
      <Variable type ='Uniform' distName='Uni2' >RavenAuxiliary|SecPGrecoveryTime|initial_value</Variable>
      -->
  </MonteCarlo>
  <MonteCarlo     name='MCSC'  limit='400' initial_seed='20'>
      <Variable type ='Normal'  distName='crew1DG1'            >DG1recoveryTime</Variable>
      <Variable type ='Uniform' distName='crew1DG2CoupledDG1'  >crew1DG2CoupledDG1</Variable>
      <Variable type ='Normal'  distName='crewSecPG'           >SecPGrecoveryTime</Variable>
      <Variable type ='Normal'  distName='CladFailureDist'     >CladTempBranched</Variable>
      <Variable type ='Normal'  distName='PrimPGrecovery'      >PrimPGrecoveryTime</Variable>
  </MonteCarlo>
</Samplers>


<Steps>
    <MultiRun name='set_up_StochCollocation'>
        <Input   type='Files'      subtype=''                     >TMI_SC.i</Input>
        <Input   type='Files'      subtype=''                     >TMI_PRA_trans_SC_control.py</Input>
        <Input   type='Files'      subtype=''                     >TMI_test_PRA_transient_less_w_ss_out_restart_0831.xda</Input>
        <Input   type='Files'      subtype=''                     >TMI_test_PRA_transient_less_w_ss_out_restart_0831_mesh.xda</Input>
        <Input   type='Files'      subtype=''                     >TMI_test_PRA_transient_less_w_ss_out_restart_0831.rd-0</Input>
        <Model   type='Models'     subtype='Code'                 >MyRAVEN</Model>
        <Sampler type='Samplers'   subtype='StochasticCollocation'>SC</Sampler>
        <Output  type='DataBases'  subtype='HDF5'                 >SC_RUN</Output>
        <Output  type='Datas'  subtype='TimePointSet'             >output_set_up_StochCollocation</Output>
    </MultiRun> 
    <SCRun name='create_ROM'>
        <Input type='DataBases'  subtype='HDF5'            >SC_RUN</Input>
        <ROM   type='Models'       subtype='StochasticCollocation'>SCrom</ROM>
        <Sampler type='Samplers'   subtype='StochasticCollocation'>SC</Sampler>
    </SCRun> 
    <MultiRun name='solve_MC'>
        <Input   type='Files'      subtype=''                >TMI.i</Input>
        <Input   type='Files'      subtype=''                >TMI_PRA_trans_MC_control.py</Input>        
        <Input   type='Files'      subtype=''                >TMI_test_PRA_transient_less_w_ss_out_restart_0831.xda</Input>
        <Input   type='Files'      subtype=''                >TMI_test_PRA_transient_less_w_ss_out_restart_0831_mesh.xda</Input>
        <Input   type='Files'      subtype=''                >TMI_test_PRA_transient_less_w_ss_out_restart_0831.rd-0</Input>
        <Model   type='Models'     subtype='Code'            >MyRAVEN</Model>
        <Sampler type='Samplers'   subtype='MonteCarlo'      >MC</Sampler>
        <Output  type='Datas'  subtype='TimePoint'           >data_for_sampling_empty_at_begin</Output>
        <Output  type='Datas'  subtype='TimePointSet'        >output_solve_MC</Output>
    </MultiRun> 
    <MultiRun name='sample_SC_ROM'>
        <Input   type='Datas'    subtype='TimePoint'   >data_for_sampling_empty_at_begin</Input>
        <Model   type='Models'   subtype='ROM'         >SCrom</Model>
        <Sampler type='Samplers' subtype='MonteCarlo'  >MCSC</Sampler>
        <Output  type='Datas'    subtype='TimePointSet'>outputMontecarloRom</Output>
    </MultiRun>
</Steps>
<OutStreams>
  <Screen name="MCScreen">
    <variable>avg_temp_clad_CH1</variable>
  </Screen> 
</OutStreams>

<Datas>
   <TimePointSet name='timepointset_from_database_for_rom_trainer' printCSV='t' operator='max'>
        <Input>DG1recoveryTime,crew1DG2CoupledDG1,SecPGrecoveryTime,CladTempBranched,PrimPGrecoveryTime</Input>
        <Output>avg_temp_clad_CH1</Output>
   </TimePointSet>
   <TimePoint name='data_for_sampling_empty_at_begin'>
        <Input name="1">DG1recoveryTime,crew1DG2CoupledDG1,SecPGrecoveryTime,CladTempBranched,PrimPGrecoveryTime</Input>
        <Output>avg_temp_clad_CH1</Output>
   </TimePoint>
   <TimePointSet name='outputMontecarloRom' printCSV='t' operator='max'>
        <Input>DG1recoveryTime,crew1DG2CoupledDG1,SecPGrecoveryTime,CladTempBranched,PrimPGrecoveryTime</Input>
        <Output>avg_temp_clad_CH1</Output>
   </TimePointSet>
    <TimePointSet name='output_solve_MC' printCSV='t' operator='max'>
        <Input>DG1recoveryTime,crew1DG2CoupledDG1,SecPGrecoveryTime,CladTempBranched,PrimPGrecoveryTime</Input>
        <Output>avg_temp_clad_CH1</Output>
   </TimePointSet>
    <TimePointSet name='output_set_up_StochCollocation' printCSV='t' operator='max'>
        <Input>DG1recoveryTime,crew1DG2CoupledDG1,SecPGrecoveryTime,CladTempBranched,PrimPGrecoveryTime</Input>
        <Output>avg_temp_clad_CH1</Output>
   </TimePointSet>
</Datas>

<DataBases>
  <HDF5 name='SC_RUN' type='MC' targetParam='avg_temp_clad_CH1' operator='max'/>
  <HDF5 name='SC_OUT' type='MC' targetParam='avg_temp_clad_CH1' operator='max'/>
</DataBases>



</Simulatio>



