#!/bin/csh -f
# Sample simulator to Dakota system call script
# See Advanced Simulation Code Interfaces chapter in Users Manual

# $argv[1] is params.in FROM Dakota
# $argv[2] is results.out returned to Dakota

# --------------
# PRE-PROCESSING
# --------------
# Incorporate the parameters from DAKOTA into the template, writing 
# gap_heat_transfer_test.i 
set num = `echo $argv[1] | cut -c 11-`

./dprepro --left-delimiter=% --right-delimiter=% $argv[1]  TMI_DEMO_PRA_Steady.template  TMI_DEMO_PRA_Steady.i
 
# --------
# ANALYSIS
# --------
~/clean_bison/trunk/raven/RAVEN-opt -i  TMI_DEMO_PRA_Steady.i > temp.out

# ---------------
# POST-PROCESSING
# ---------------
cp  TMI_DEMO_PRA_Steady_out.csv  $num.csv

# extract function value from the simulation output
tail -2   TMI_DEMO_PRA_Steady_out.csv| head -1 | cut -f24 -d',' > results.tmp
mv results.tmp $argv[2]
