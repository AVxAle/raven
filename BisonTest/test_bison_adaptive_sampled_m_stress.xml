<?xml version="1.0" encoding="UTF-8"?>
<Simulation>
<RunInfo>
    <WorkingDir>/Users/alfoa/projects/trunk/raven/BisonTest/AdaptiveSampledMaxStress</WorkingDir>
    <Files>inputSmeared.i,peakingfactors12.csv,powerhistory.csv,smeared.e,BisonOut.csv</Files>
    <Sequence>adaptiveBison</Sequence>
    <batchSize>100</batchSize>
    <expectedTime>24:00:00</expectedTime>
    <ParallelProcNumb>1</ParallelProcNumb>
    <mode>pbsdsh</mode>
    <NumThreads>1</NumThreads>     
    <!--<mode>mpi</mode>
    NumMPI>10</NumMPI>
    <ParallelCommand></ParallelCommand>
    <ThreadingCommand></ThreadingCommand>
    <NumThreads></NumThreads>
    <quequingSoftware></quequingSoftware>
    <procByNode></procByNode>
    <numProcByRun></numProcByRun>
    <totNumbCores></totNumbCores>-->
</RunInfo>

<Models>
    <Code name='Bison-opt' subType='MooseBasedApp'>%FRAMEWORK_DIR%/../../bison/bison-%METHOD%</Code>
</Models>

<Distributions>
    <Uniform name='FlatPowerHistory'>
        <low>0.95</low>
        <hi>1.05</hi>
    </Uniform>
    <Uniform name='FlatYoung'>
        <low>9.74e9</low>
        <hi>16.26e9</hi>
    </Uniform>
    <Uniform name='max_stress_spl_dist'>
        <low>3.20e5</low>
        <hi>1.30e6</hi>
    </Uniform>
</Distributions>

<Samplers>
  <Adaptive name='Bison1' adaptiveAlgorithm='leastDistance' initial_seed='10'>
    <Convergence norm='relL2' limit='500' forceIteration='False' weight='probability' persistence='8'>0.00001</Convergence>
    <variable name='Functions|power_history|scale_factor' >
      <distribution type ='Uniform'>FlatPowerHistory</distribution>
    </variable>
    <variable name='Materials|clad_solid_mechanics|clad_solid_mechanics|youngs_modulus' >
      <distribution type ='Uniform'>FlatYoung</distribution>
    </variable>
    <variable name='Postprocessors|max_stress_spl|default' >
      <distribution type ='Uniform'>max_stress_spl_dist</distribution>
    </variable>
  </Adaptive>
</Samplers>
<Functions>
  <External name='bisonFunction_sampledStress' file='bisonFunction_sampledStress.py'>
    <variable type='numpy.ndarray'>scale_factor</variable>
    <variable type='numpy.ndarray'>youngs_modulus</variable>
    <variable type='numpy.ndarray'>max_stress_spl</variable>
    <variable type='numpy.ndarray'>max_stress</variable>
  </External>
</Functions>
<Steps>
    <Adaptive name='adaptiveBison' sleepTime='1'>
        <Input   class = 'Files'      type=''          >inputSmeared.i</Input>
        <Input   class = 'Files'      type=''          >peakingfactors12.csv</Input>
        <Input   class = 'Files'      type=''          >powerhistory.csv</Input>
        <Input   class = 'Files'      type=''          >smeared.e</Input>
        <Model             class='Models'           type='Code'       >Bison-opt</Model>
        <Sampler           class='Samplers'         type='Adaptive'    >Bison1</Sampler>
        <TargetEvaluation  class='Datas'            type='TimePointSet'>adaptiveOut</TargetEvaluation>
        <SolutionExport    class='Datas'            type='TimePointSet'>LimitSurf</SolutionExport>
        <Function          class='Functions'        type='External'    >bisonFunction_sampledStress</Function>
        <Output            class='Datas'            type='TimePointSet'>adaptiveOut</Output>
        <!-- <Output            class='OutStreamManager' type='Plot'        >2DLimitSurfPlot</Output> -->
        <Output            class='OutStreamManager' type='Plot'        >3DLimitSurfPlot</Output>
    </Adaptive> 
</Steps>

<Datas>
    <TimePointSet name='adaptiveOut'>
        <Input>Functions|power_history|scale_factor,Materials|clad_solid_mechanics|clad_solid_mechanics|youngs_modulus,Postprocessors|max_stress_spl|default</Input>
        <Output>max_stress</Output>
   </TimePointSet>
    <TimePointSet name='LimitSurf'>
        <Input>Functions|power_history|scale_factor,Materials|clad_solid_mechanics|clad_solid_mechanics|youngs_modulus,Postprocessors|max_stress_spl|default</Input>
        <Output>max_stress</Output>
   </TimePointSet>
</Datas>
<OutStreamManager>
  <Plot name='3DLimitSurfPlot' dim='3' interactive='False' overwrite='False'>
    <plot_settings>
      <plot>
        <type>surface</type>
        <x>LimitSurf|Input|(Functions|power_history|scale_factor)</x>
        <y>LimitSurf|Input|(Materials|clad_solid_mechanics|clad_solid_mechanics|youngs_modulus)</y> 
        <z>LimitSurf|Input|(Postprocessors|max_stress_spl|default)</z>
        <interpolation_type>nearest</interpolation_type>
        <interpPointsY>100</interpPointsY>
        <interpPointsX>100</interpPointsX> 
      </plot>
      <xlabel>power scale factor</xlabel>
      <ylabel>youngs modulus</ylabel>
      <zlabel>max stress failure</zlabel>
    </plot_settings>
    <actions>
      <how>pdf</how>
    </actions>
  </Plot>
</OutStreamManager>
</Simulation>



